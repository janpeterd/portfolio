<script>
  import { cn } from '$lib/utils'

  export let className = undefined
  export let containerClassName = undefined
  export let isMouseEntered = false

  let containerRef

  const handleMouseMove = (e) => {
    if (!containerRef) return
    const { left, top, width, height } = containerRef.getBoundingClientRect()
    const x = (e.clientX - left - width / 2) / 15
    const y = (e.clientY - top - height / 2) / 15
    containerRef.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`
  }

  const handleMouseEnter = (e) => {
    isMouseEntered = true
    if (!containerRef) return
  }

  const handleMouseLeave = (e) => {
    if (!containerRef) return
    isMouseEntered = false
    containerRef.style.transform = `rotateY(0deg) rotateX(0deg)`
  }
</script>

<div
  class={cn('flex items-center justify-center py-20', containerClassName)}
  style="perspective: 800px;"
>
  <div
    bind:this={containerRef}
    on:mouseenter={handleMouseEnter}
    on:mousemove={handleMouseMove}
    on:mouseleave={handleMouseLeave}
    class={cn(
      'relative flex items-center justify-center transition-all duration-200 ease-linear',
      className
    )}
    style="transform-style: preserve-3d;"
  >
    <slot />
  </div>
</div>
